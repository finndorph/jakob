#summary How to deploy JAKOB in the WAYF setup

Deploying JAKOb in a WAYF like setup requires you to:
 * Deploy JAKOB
 * Deploy a connector (AuthProc filter) on your WAYF to connect to JAKOB

*NOTE* that the prerequisites list aplies to the current WAYF setup.

= Prerequisites =
The following list of requirements for the JAKOB is non-exhaustive and will be extended in the near future.

== Global ==
 * MySQL database (accessible from both WAYF server and JAKOB server), can be located anywhere.

== WAYF server ==
 * All requirements for a SimpleSAMLphp server (see http://simplesamlphp.org/docs/1.8/simplesamlphp-install)
 * PDO and the appropriate driver (mysql)

== JAKOB server ==
 * Ubuntu Server 10.04 LTS
 * Apcahe/2.2 (latest stable on Ubuntu) 
 * PHP version 5.3.2 or higher (latest stable on Ubuntu)
 * libgearman > 0.21 (for latest Gearman PECL extension)
 * Gearman Job Server 
 * Gearman PECL extension
 * Memcache
 * Memcache PHP extension

= Installing JAKOB =
== Installing JAKOB filter on WAYF ==
You need to check out the SimpleSAMLphp authentication processing filter in the modules directory of your SSP installation
{{{
$ svn export http://jakob.googlecode.com/svn/trunk/ssp-module/jakob <SSP-DIR>/modules/jakob
}}}
Then copy the config template file to the config dir and edit to fit your needs
{{{
$ cp <SSP-DIR>/modules/jakob/config-templates/module_jakob.php <SSP-DIR>/config/
}}}
Config file  (modify for your setup)
{{{
$config = array(
    'dsn'      => 'mysql:host=localhost;dbname=jakob_db',
    'username' => 'jakobuser',
    'password' => 'jakobpass',
    'table'    => 'jakob__configuration',
    'salt'     => 'pezo340fkvd3afnywz3ab2fuwf5enj8h',

    'joburl'   => 'http://JAKOB-URL/job/',
);
}}}
Next you should add the filter to your configuration. It can be placed in any of the places authproc filters are configured. Below is an example configuration:
{{{
'authproc.idp' => array(
    10 => array(
        'class' => 'jakob:jakob',    
    ),
),
}}}

== Installing the JAKOB server ==
*NOTE* that this guide applies to the current WAYF setup. Your setup may vary.


= Maintanaince =

Find all workers (conectors) running
{{{
$ pgrep -f connector-worker.php
}}}

Kill all running workers
{{{
$ pkill -f connector-worker.php
}}}

See running workers
{{{
$ nc localhost 4730
- status
- workers
}}}